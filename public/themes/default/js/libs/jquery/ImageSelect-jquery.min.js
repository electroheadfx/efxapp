!function(a){function b(b,c,d,e,f,g){var h=a(c).data("img-src");void 0!=h&&h>""&&(b=a(b),text=a(c).text(),f=void 0!=f?f:!0,g=g||(f?"chose-image":"chose-image-small"),g=e?g+" rtl":g,d=d.replace("{url}",h).replace("{class_name}",g).replace("{text}",text),b.empty(),e&&f?b.append(d):b.prepend(d))}function c(b){for(var c=[],d=a(b.form_field).find("option:selected")||[],e=a(b.container).find(b.is_multiple?".chosen-choices span":".chosen-single span"),f=0;f<d.length;f++)for(var g=0;g<e.length;g++)a(e[g]).text()==a(d[f]).text()&&c.push({span:e[g],option:d[f]});return c}var d='<img class="{class_name}" src="{url}" />',e=a.fn.chosen;a.fn.extend({chosen:function(f){f=f||{};e.apply(this,arguments);return this.each(function(){var e=a(this),g=e.data("chosen");e.on("chosen:hiding_dropdown",function(a,e){for(var g=c(e.chosen),h=e.chosen.is_rtl,i=e.chosen.is_multiple,j=f.html_template||(h&&i?"{text}"+d:d+"{text}"),k=0;k<g.length;k++)b(g[k].span,g[k].option,j,h,i)}),e.on("chosen:showing_dropdown",function(c,e){for(var e=e.chosen,g=e.form_field.options||[],h=e.is_rtl,i=f.html_template||(h?"{text}"+d:d+"{text}"),j=a(e.container).find(".chosen-drop ul li:not(:has(img))"),k=0;k<j.length;k++){var l=j[k],m=a(g[k]),n=a(l).attr("data-option-array-index");n&&(m=g[e.results_data[n].options_index],b(l,m,i,h,!0,"chose-image-list"))}}),e.on("chosen:ready",function(a,b){e.trigger("chosen:hiding_dropdown",b)}),e.on("chosen:updated",function(){e.trigger("chosen:hiding_dropdown",{chosen:g})}),e.on("chosen:filter",function(a,b){e.trigger("chosen:showing_dropdown",{chosen:b.chosen})}),"undefined"!=typeof g&&e.trigger("chosen:hiding_dropdown",{chosen:g})}),a(this)}})}(jQuery);