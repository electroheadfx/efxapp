$(window).load(function(){function a(a){a=a||window.location.href;for(var b={},c=a.slice(a.indexOf("#")+1).split("&"),d=0;d<c.length;d++){var e=c[d].split("=");b[e[0]]=e.length>1?e[1]:null}return b}function b(b,c){if(!c&&void 0===cb){var d=a(location.hash);location.hash=void 0==d.c?"p="+encodeURIComponent(b.data("slug")):"p="+encodeURIComponent(b.data("slug"))+"&c="+d.c}}function c(a){location.hash;if("c"==a)var b=location.hash.match(/c=([^&]+)/i);else var b=location.hash.match(/p=([^&]+)/i);var c=b&&b[1];return c&&decodeURIComponent(c)}function d(){$("#frontend-control .btn.active").removeClass("active"),$("#desc").addClass("active"),w.isotope({filter:filterValue,sortBy:"original-order",sortAscending:!0})}function e(){$("#frontend-control .btn.active").removeClass("active"),$("#asc").addClass("active"),w.isotope({filter:filterValue,sortBy:"original-order",sortAscending:!1})}function f(){$("#frontend-control .btn.active").removeClass("active"),$("#favorites").addClass("active"),w.isotope({filter:".favorite",sortAscending:!0})}function g(){$("#frontend-control .btn.active").removeClass("active"),$("#random").addClass("active"),w.isotope({filter:filterValue,sortBy:"random"}).isotope("updateSortData")}function h(){(H||L)&&1>G&&(F.animate({scrollTop:B.find(".player").offset().top},"slow",function(){w.off("layoutComplete",h),L=!1}),G++)}function i(){var a=$('#articles .article.active [data-module="video"]');a.each(function(){var a=$(this).data("id");$("#"+a).attr("data-plyr")&&(P=Plyr.get("#plyr-instance-"+a),P[0].pause())});var b=$('#articles .article.active [data-module="sketchfab"]');b.each(function(){var a=$(this).data("sktechid");Y[a].stop()})}function j(a,c){i(),c=void 0==c?!1:c,a.tooltip("hide");var d=a.parent().parent(),e=("no"==a.data("fullscreen")?!1:!0,!0);b(a,c),y=a.data("bootstrap"),parentblock=$(this).parent(),x=a.data("column-open"),d.find(".preview").show(),d.find(".js-sketchfab").hide(),d.find(".media-ico").hide(),B=d,parentblock.removeClass(y).addClass(E).addClass(active),d.removeClass(y).addClass(x).addClass(active).addClass("animate"),d.one("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",function(b){b.stopPropagation(),$(this).off(b);var c=a.data("sktechid"),f=d.find(".preview");T=$("#sketch"+c),e&&(e=!1,d.find(".js-sketchfab .sketchframe").attr("height",f.height()),"no"==T.attr("data-sketchloaded")?(U=a.data("sketchfab"),V="1.0.0",W=document.getElementById("sketch"+c),X=new Sketchfab(V,W),X.init(U,{success:function(a){f.fadeOut(100,function(){f.hide(),d.find(".js-sketchfab").show()}),Y[c]=a,Y[c].start()},error:function(){alert("Sketchfab API Error!")}}),T.attr("data-sketchloaded","yes")):(d.find(".preview").hide(),d.find(".js-sketchfab").show(),Y[c].start()),setTimeout(function(){B=d,G=0,w.on("layoutComplete",h),w.isotope("layout")},100))})}function k(a,c){i(),c=void 0==c?!1:c,a.tooltip("hide");var d=a.parent().parent(),e="no"==a.data("fullscreen")?!1:!0,f=!0;b(a,c),y=a.data("bootstrap"),x=a.data("column-open"),d.removeClass(y).addClass(x).addClass(active).addClass("animate"),d.find(".preview").show(),d.one("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",function(b){if(b.stopPropagation(),$(this).off(b),Q&&Q.pause(),R&&R.pause(),S&&S.api("pause"),O=a.data("id"),is_plyr=$("#plyr"+O).attr("data-plyr"),f){if(f=!1,d.find(".preview").hide(),is_plyr){g=P["plyr"+O];try{g.play()}catch(c){console.error(c)}}else{options={fullscreen:{enabled:e}};try{var g=new Plyr("#plyr-instance-"+O,options);P["plyr"+O]=g}catch(c){console.error(c)}$("#plyr"+O).attr("data-plyr",!0),$("#plyr"+O).addClass("plyr-"+O);try{void 0!==g&&g.on("ready",function(a){d.find(".preview").hide();var b=a.detail.plyr;b.play()})}catch(c){console.error(c)}}setTimeout(function(){B=d,G=0,w.on("layoutComplete",h),w.isotope("layout")},500),setTimeout(function(){w.isotope("layout")},100)}})}function l(a,c){i(),c=void 0==c?!1:c,a.tooltip("hide");var d,e,f,g=a.next(".summary_preview"),h=a.data("target"),j=($("#"+h+"-img-hd"),$("#"+h+"-player")),k=a.parent().parent();B=k;{var l=a.data(""==a.data("gallery-width")?"width":"gallery-width"),m=a.data(""==a.data("gallery-height")?"height":"gallery-height"),n=(a.data("ratio"),"no"==a.data("fullscreen")?!1:!0),o=a.data("flickity_nav"),p=a.data("flickity_play"),q=a.data("flickity_delay");a.data("title_expander")}C=!0,g.fadeOut(0),b(a,c),$("#articles .article").css("z-index",1),k.css("z-index","2");var r=k.find(".carousel.flickity-enabled.carousel");r.length>0&&r.flickity("destroy"),r=k.find(".carousel"),k.find(".preview").show(),D=!0,y=a.data("bootstrap"),active_grid_thumb=$("#articles .article.active .thumb").data("bootstrap"),x=a.data("column-open"),$(".article.active .player .info-bottom").hide(),r.fadeTo(0,0).hide(),k.removeClass(y).addClass(x).addClass(active).addClass("animate"),k.one("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",function(a){if(a.stopPropagation(),$(this).off(a),C){C=!1,r.show(),d=m/l;var b;1>d?(f=j.find(".js-media-player").width(),b=f*d):(e=$(window).height(),b=e/d-40),j.find(".carousel .carousel-cell").css("height",b),z=r,k.find(".preview").fadeOut("slow"),z.on("ready.flickity",function(){r.fadeTo(1e3,1),k.find(".preview").hide()}),z.flickity({lazyLoad:1,pageDots:k.find(".carousel-cell").length>1&&o?!0:!1,autoPlay:p?q:!1,imagesLoaded:!0,fullscreen:n,dragThreshold:10,wrapAround:!0,draggable:">1",arrowShape:{x0:22,x1:52,y1:38,x2:58,y2:38,x3:28}}),$('[data-toggle="tooltip-fullscreen"]').tooltip({placement:"auto bottom",html:!0,container:"body"}),$('[data-toggle="tooltip-close"]').tooltip({placement:"auto bottom",html:!0,container:"body"}),n&&z.on("fullscreenChange.flickity",function(a,c){var d=$(this).parent().attr("id"),e=$("#"+d+"-article");c?($("#articles .article:not(#"+d+"-article)").hide(),$("header").hide(),$("#sidebar").hide(),e.find(".carousel .carousel-cell").css("height","100%")):(e.find(".flickity-viewport").css("height",b),$("header").show(),$("#sidebar").show(),$("#articles .article").show(),w.isotope({filter:"*"}),w.isotope({filter:filterValue}))}),C=!0,w.isotope("layout"),c||setTimeout(function(){F.animate({scrollTop:k.find(".player").offset().top},"slow",function(){L=!1})},100)}})}function m(a,b){switch(b||(L=!0),N&&($(".thumb.featured").each(function(){r($(this))}),N=!1),"auto"==J&&r(),a.data("module")){case"gallery":l(a,b);break;case"video":k(a,b);break;case"sketchfab":j(a,b);break;default:console.log("Unknown media. No action.")}}function n(){var b=a(location.hash);location.hash=b.c?"c="+b.c:""}function o(a){if(O=a.parent().parent().find(".js-media-plyr").attr("id"),void 0!=O)try{player=P[O],player.pause()}catch(b){console.error(b)}Q&&Q.play(),R&&R.play(),S&&S.api("play")}function p(){return!0}function q(a){a.find(".preview").hide(),a.find(".media-ico").show();var b=a.data("sktechid");Y[b].stop()}function r(a){var b;if(D=!1,a)b=a.parent().parent(),player_ui=a.find(".player .info-bottom"),player=a.find(".player"),y=a.data("bootstrap"),player_ui.fadeOut(100),x=a.data("column-open"),Z["close_"+a.data("module")](a),b.removeClass(x).removeClass(active).addClass(y),b.one("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",function(){player_ui.fadeIn(0),a.next(".summary_preview").fadeIn(0),setTimeout(function(){w.isotope("layout")},100)});else{var c=$("#articles .article.active");c.each(function(){close_el=$(this),player_ui=close_el.find(".player .info-bottom"),player=close_el.find(".player"),y=$("#articles .article.active .thumb").data("bootstrap"),player_ui.fadeOut(100),x=$(".article.active .thumb").data("column-open"),thumb=close_el.find(".thumb-container .thumb "),Z["close_"+thumb.data("module")](thumb),close_el.removeClass(x).removeClass(active).addClass(y),close_el.one("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",function(){player_ui.fadeIn(0),close_el.next(".summary_preview").fadeIn(0),setTimeout(function(){w.isotope("layout")},100)})})}}function s(){var a=c("c"),b=c("p");(a||!bb)&&(bb=!0,w.isotope({layoutMode:"packery",itemSelector:".grid-item",filter:a,animationOptions:{duration:500,easing:"swing"}}),a&&($(".button-category .active").removeClass("active"),"*"==a?$(".button-category .all").addClass("active"):$(".button-category "+a).addClass("active")),b&&m($('[data-slug="'+b+'"]'),!1))}function t(){D&&($("#articles .article.active").find(".flickity-viewport").css("height",A),z.flickity("exitFullscreen"),$("#articles .article").show(),$("header").show(),$("#sidebar").show())}function u(a){return 0===a?1:void setTimeout(function(){F.animate({scrollTop:$("#"+M[a-1]).offset().top},"slow",function(){u(a-1)})},a==M.length?1e3:I)}var v,w=$("#articles");filterValue=void 0==a(location.hash).c?"*":a(location.hash).c;var x,y,z,A,B,C,D=!1,E="col-xs-12 col-sm-12 ",F=$("html, body"),G=0,H="active"==$(".navbar-nav .menu.active").data("scrollto")?!0:!1,I=$(".navbar-nav .menu.active").data("scrollpausetime"),J=$(".navbar-nav .menu.active").data("mediaautoclose"),K=","+$(".navbar-nav .menu.active").data("scrolltofeatured"),L=!1,M=[],N=!1;filter=$(".filters a.active").data("filter"),active="active",pending="pending";var O,P={},Q=document.getElementById("sider-video-background"),R=document.getElementById("video-background"),S=!1;if(!R){var T=document.getElementById("vimeo-video-background");T&&(S=$f(T))}var U,V,W,X,Y={};$.fn.scrollView=function(){return this.each(function(){$("html, body").animate({scrollTop:$(this).offset().top},1e3)})};var Z={close_gallery:p,close_video:o,close_sketchfab:q};if($filters=$(".filters .button-category a").on("click touchstart",function(b){b.preventDefault(),$(".collapse.navbar-collapse.navbar-right").removeClass("in"),$(".filters a.active").removeClass("active"),$(this).addClass("active"),filterValue=$(this).data("filter");var c=a(location.hash);return c.p?(location.hash="c="+c.c+"&",location.hash="p="+c.p+"&c="+encodeURIComponent(filterValue)):location.hash="c="+encodeURIComponent(filterValue),w.isotope({filter:filterValue}),!1}),$("#frontend-control").length)switch($("#desc").on("click touchstart",d),$("#asc").on("click touchstart",e),$("#favorites").on("click touchstart",f),$("#random").on("click touchstart",g),active_control=$("#frontend-control .btn.active").attr("id")){case"desc":d();break;case"asc":e();break;case"favorites":f();break;case"random":g();break;default:d()}var _=function(){$(".summary").one("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",function(){w.isotope("layout")}),w.isotope("layout")};$("img.thumbnail.wall").addClass("lazyload");var ab=function(a){$(a.target).parent().hasClass("thumb-lazyloading")&&($(a.target).parent().removeClass("thumb-lazyloading").addClass("thumb-lazyloaded"),setTimeout(function(){w.isotope("layout")},300)),a.target.className.indexOf("carousel-cell-image")>=0&&(setTimeout(function(){$(a.target).parent().removeClass("carousel-cell-lazyloading").addClass("carousel-cell-lazyloaded")},1e3),player=$("#"+$(a.target).data("id")+"-player"),player.hasClass("loaded")||setTimeout(function(){player.addClass("loaded")},1e3)),this.removeEventListener("load",ab)};window.addEventListener("lazyloaded",ab),$(".expander.expander-summary").each(function(){$(this).expander({slicePoint:$(".menu.active").data("slicepoint"),preserveWords:!0,widow:4,startExpanded:$(this).data("status_expander"),expandEffect:"fadeIn",userCollapseEffect:"fadeOut",afterExpand:_,afterCollapse:_,detailPrefix:" ",expandPrefix:" ",summaryClass:"expandsummary",expandText:'<span class="fa fa-plus-circle" data-original-title="'+$(this).data("open-summary")+'" data-tooltip="expandable" ></span>',userCollapseText:'<span class="fa fa-minus-circle" data-original-title="'+$(this).data("close-summary")+'" data-tooltip="expandable" ></span>'})}),$(".expander.expander-content").each(function(){$(this).expander({slicePoint:$(".menu.active").data("slicepoint"),preserveWords:!0,widow:4,startExpanded:$(this).data("status_expander"),expandEffect:"fadeIn",userCollapseEffect:"fadeOut",afterExpand:_,afterCollapse:_,detailPrefix:" ",expandPrefix:" ",summaryClass:"expandsummary",expandText:'<span class="fa fa-plus-circle" data-original-title="Ouvrir le contenu" data-tooltip="expandable" ></span>',userCollapseText:'<span class="fa fa-minus-circle" data-original-title="Fermer le contenu" data-tooltip="expandable" ></span>'})}),$('[data-toggle="tooltip-sort"]').tooltip({placement:"auto top",html:!0,container:"body"}),$('[data-tooltip="navbar"]').tooltip({placement:"auto bottom",html:!0,container:"body"}),$('[data-tooltip="expandable"]').tooltip({placement:"auto right",html:!0,container:"body"}),$('[data-toggle="tooltip"]').each(function(){var a=$(this).closest(".article").find(".thumb");if(!a.hasClass("locked")){var b=a.data("name"),c=a.data("id"),d=a.data("slug"),e=a.data("meta"),f=a.data("date"),g=a.data("category"),h='<div style="text-align:left; margin-bottom:10px;">';h=h+"<strong>ID : </strong>"+c+"</br>",""!==b&&(h=h+"<strong>Name : </strong>"+b+"</br>"),h=h+"<strong>Slug : </strong>"+d+"</br>",h=h+"<strong>Category : </strong>"+g.replace(" ",", ")+"<br/>",h=h+"<strong>Meta : </strong>"+e+"<br/>",h=h+"<strong>Date : </strong>"+f+"</div>",$(this).tooltip({title:h,html:!0,delay:{show:1600,hide:200}})}}),$("#articles .article .thumb").on("click",function(a){a.preventDefault(),"no"==$(this).data("locked")&&m($(this),!1)}),$(".thumb").hover(function(){img=$(this).find("img"),$(".thumb .title-hover").hide(),current=$(this),img.hasClass("lazyloaded")&&current.find(".title-hover").text()&&img.fadeTo(150,.5,function(){current.find(".title-hover").show()})},function(){img.hasClass("lazyloaded")&&current.find(".title-hover").text()&&(img.fadeTo(50,1),current.find(".title-hover").hide())}),$(".close-article, .gallery-close").on("click touchstart",function(a){a.preventDefault();var b=$(this).closest(".article.active").find(".thumb");r(b),b.scrollView(),n()});var bb=!1;$(".navbar-toggle.x").click(function(){$(".navbar-brand").is(":hidden")&&($(this).hasClass("collapsed")?($(".tpcontainer").css("padding-left",""),$("#sidebar").show(200,function(){w.isotope("layout"),$(".navbar-toggle.x").removeClass("collapsed")})):($(this).addClass("collapsed"),$(".tpcontainer").css("padding-left","40px"),$("#sidebar").hide(200),$("#sidebar").hide(200,function(){w.isotope("layout"),$(".navbar-toggle.x").addClass("collapsed")})))}),$(window).on("hashchange",s),$(window).resize(function(){clearTimeout(v),v=setTimeout(t,500),$(".navbar-brand").is(":hidden")?$(".navbar-toggle.x").removeClass("collapsed"):($(".navbar-toggle.x").addClass("collapsed"),$(".tpcontainer").css("padding-left",""),$("#sidebar").show())}),$(window).bind("mousewheel DOMMouseScroll",function(){F.stop()}),$($(".thumb.featured").get().reverse()).each(function(){m($(this),!0);var a=$(this).parent().parent().attr("id"),b=a.replace("-article","");-1!==K.indexOf(b)&&M.push(a)});var cb=$("#articles").data("product");""!==cb&&m($('[data-slug="'+cb+'"]'),!0),H&&u(M.length),s()});