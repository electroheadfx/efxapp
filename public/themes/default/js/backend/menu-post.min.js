$(function(){function a(){k=$("#edit_content").attr("data-id"),l=$("#edit_content").attr("data-save"),m=["undo","redo","|","bold","italic","paragraphFormat","fontSize","color","|","insertHR","quote","align","|","subscript","superscript","fontFamily","fontSize","|","paragraphStyle","|","emoticons","nowrapspace","wrapspace","-","formatOL","formatUL","outdent","indent","insertLink","insertImage","insertVideo","insertFile","insertTable","clearFormatting","|","html","|","savearticle","|","fullscreen","|"],n=$("#edit_summary").attr("data-crop"),o=$("#edit_summary").attr("data-size"),p=$("#edit_summary").attr("data-folder"),q=$("#edit_summary").attr("data-algorythm"),r=$("#edit_summary").attr("data-upload"),s=$("#edit_summary").attr("data-delete"),t=$("#edit_summary").attr("data-gallery")}function b(){u.each(function(){var a=$(this).data("froala.editor");a.opts.imageUploadURL=r+w,a.opts.imageManagerLoadURL=t+x})}function c(a){var b=$("#uri_wrapper");a?(b.show(),$("#uri").attr("required","required")):(b.hide(),$("#uri").attr("required",!1))}function d(a){a?$(".scrolltofeatured_wrapper").hide():$(".scrolltofeatured_wrapper").show()}function e(a){a?$(".postmax_wrapper").hide():$(".postmax_wrapper").show()}function f(a){a?($("#image-resize-summary").show(),$("#froala-summary").show()):($("#image-resize-summary").hide(),$("#froala-summary").hide())}function g(){$("#scrolltofeatured").chosen({width:"200",html_template:'{text} <img style="border:1px solid #666;padding:0px;margin-right:4px"  class="{class_name}" src="{url}" />'})}function h(){var a=$("select#menutype :selected").val(),b=$("select#menutype :selected").parent().attr("label"),c=$("#route");"Modules"==b&&c.attr("readonly","readonly"),"uri"==a&&c.attr("readonly","readonly")}function i(a,b,c){var d,e=document.createElement("INPUT");"color"==b&&(d=new jscolor(e)),a.append(e);var f=void 0==a.data(b)?"":a.data(b);"color"==b?d.fromString(0==f.length?c:f):a.find("input").val(0==f.length?c:f),a.find("input").addClass("form-control").attr("name",a.data("type")+"data").attr("id",a.data("type")+"data")}function j(a,b){switch(a){case"color":data_default="000000",i(b,a,data_default);break;case"hexa":data_default="#",i(b,a,data_default);break;case"video":data_default="http://thenewcode.com/assets/videos/polina.mp4",i(b,a,data_default);break;case"vimeo":data_default="178087547",i(b,a,data_default)}}var k,l,m,n,o,p,q,r,s,t;a();var u=$(".edit_froala_summary"),v="/"+n+"/"+o+"/"+q,w="/"+p+v,x="?index="+p;if($(".nav-tabs.tab-menu a").click(function(a){a.preventDefault(),$(this).tab("show")}),$(document).click(function(){$(".alert").hide()}),$('[data-toggle="tooltip"]').tooltip({placement:"auto bottom",html:!0,container:"body"}),$("a.lang-switcher").click(function(a){a.preventDefault(),$(this).hasClass("active")||(lang=$(this).attr("href"),el=$(this).parent().parent(),el.find(".localisation").not(".hidden").addClass("hidden"),el.find(".localisation."+lang).removeClass("hidden"),el.find("a.lang-switcher").removeClass("active"),$(this).addClass("active"))}),$("a.lang-switcher-textarea").click(function(a){a.preventDefault(),activeli=$(this).parent(),activeli.hasClass("active")||(el=activeli.parent().parent(),lang=$(this).attr("href"),el.find(".localisation").not(".hidden").addClass("hidden"),el.find(".localisation."+lang).removeClass("hidden"),lang=$(this).attr("href"),activeli.parent().find("li.active").removeClass("active"),activeli.addClass("active"))}),void 0!=k&&($.FroalaEditor.DefineIcon("savearticle",{NAME:"save"}),$.FroalaEditor.RegisterCommand("savearticle",{title:"Sauvegarde",focus:!0,undo:!0,refreshAfterCallback:!0,callback:function(){this.$oel.froalaEditor("save.save")}})),InlineStyle={"Big c2v":"font-size: 20px; color: red;","Small c2v":"font-size: 14px; color: blue;"},LinkList=[{text:"Pierre nogueras",href:"http://pierrenogueras.com",target:"_blank",rel:"nofollow"},{displayText:"Froala",href:"https://froala.com",target:"_blank"}],ParagraphStyles={"fr-text-gray":"Gris","fr-text-bordered":"Encadré","fr-text-spaced":"Espacé","fr-text-uppercase":"Capitale"},u.each(function(){var a=$(this).parent().parent().parent();$(this).froalaEditor({toolbarInline:!1,toolbarSticky:!0,requestWithCORS:!1,imageUploadURL:r+w,imageManagerDeleteURL:s,imageManagerLoadURL:t+x,imageParams:{id:a.attr("id")},pastePlain:!0,imageDefaultAlign:"left",imageDefaultWidth:0,imageDefaultAlign:"left",toolbarButtons:m,toolbarButtonsMD:m,toolbarButtonsSM:m,toolbarButtonsXS:m,inlineStyles:InlineStyle,linkList:LinkList,paragraphStyles:ParagraphStyles,dragInline:!1,imageResize:!0,tabSpaces:4,codeMirrorOptions:{tabSize:4},saveParams:{id:void 0!=k?k:null,body:a.attr("id")},saveParam:a.attr("id"),saveURL:void 0!=k?l:null,enter:$.FroalaEditor.ENTER_BR,language:$("#edit_summary").data("lang")}).on("froalaEditor.image.beforeUpload",function(){})}),void 0!=k&&(u.on("froalaEditor.save.after",function(){$(".bb-alert.summary").delay(200).fadeIn().delay(1e3).fadeOut()}),u.on("froalaEditor.save.error",function(){$(".bb-alert.error").delay(200).fadeIn().delay(2e3).fadeOut()})),$(".foldermedia").change(function(){$("#edit_summary").attr("data-folder",this.value),a(),x="?index="+this.value,w="/"+this.value+v,b()}),$(".size").change(function(){$("#edit_summary").attr("data-size",this.value),a(),v="/"+n+"/"+this.value+"/"+q,w="/"+p+v,b()}),$(".crop").change(function(){$("#edit_summary").attr("data-crop",this.value),a(),v="/"+this.value+"/"+o+"/"+q,w="/"+p+v,b()}),$(".algorythm").change(function(){$("#edit_summary").attr("data-algorythm",this.value),a(),v="/"+n+"/"+o+"/"+this.value,w="/"+p+v,b()}),$(".selectpicker").selectpicker(),$("#uri_state").change(function(){c($(this).prop("checked"))}),c($("#uri_state").prop("checked")),$("#selectmode").change(function(){d($(this).prop("checked"))}),d($("#selectmode").prop("checked")),$("#postselect").change(function(){e($(this).prop("checked"))}),e($("#postselect").prop("checked")),$("#summary_switch").change(function(){f($(this).prop("checked"))}),f($("#summary_switch").prop("checked")),$("#scrolltofeatured").on("change",function(a,b){var c=b.selected,d="ID"+c;"scrolltofeatured_featured"==$('select#scrolltofeatured option[value="'+c+'"]').parent().attr("id")&&(select=$("#scrolltofeatured_chosen .search-choice span:contains("+d+")"),select.parent().addClass("featured"))}),$("#scrolltofeatured").on("chosen:ready",function(){$("select#scrolltofeatured option:selected").each(function(){if("scrolltofeatured_featured"==$(this).parent().attr("id")){var a=$(this).val(),b="ID"+a,c=$("#scrolltofeatured_chosen .search-choice span:contains("+b+")");c.parent().addClass("featured")}})}),g(),$.get("/assets/data/fa-icons.yml",function(a){var b=jsyaml.load(a);$("#select").append('<option value="none">Aucun</option>'),$.each(b.icons,function(a,b){$("#select").append('<option value="fa fa-'+b.id+'"> &#x'+b.unicode+" "+b.id+"</option>")}),$("#select").chosen({enable_split_word_search:!0,search_contains:!0}),$("#select").val($("#select").data("model-faicon")),$("#select").trigger("chosen:updated")}),$("#chosen-categories").chosen({}),$("#select").change(function(){$("#modelfaicon").val($(this).val())}),h(),select_open=$("select#menutype option:selected").val(),"uri"==select_open){var y=$("#form_name"),z=$("#route");y.bind("input",function(){uri=y.val().toLowerCase().replace(/[^a-zA-Z0-9\s]/g,"").replace(/ /g,"-"),z.val("/cms/"+uri)})}else"url"==select_open&&$(".froala").hide();$("select#menutype").on("change",function(){var a=this.value,b=$(this).data("modules"),c=this.options[this.selectedIndex].parentNode.label,d=$("#route"),e=$("#form_name"),f=$("#form_target");if(d.removeAttr("readonly"),e.unbind("input"),$(".froala").show(),"Modules"==c){e.val(a.charAt(0).toUpperCase()+a.slice(1));var g=b[a].route;d.val(g),f.val("_self"),$("#select").val("fa fa-"+b[a].icon),$("#select").trigger("chosen:updated"),$("#modelfaicon").val("fa fa-"+b[a].icon),d.attr("readonly","readonly"),$("#chosen-categories option").prop("selected",!1),$("#chosen-categories option").prop("disabled",!0),$("#chosen-categories option."+g).prop("disabled",!1),$("#chosen-categories option.uncategorized").prop("selected",!0),$("#chosen-categories").trigger("chosen:updated")}else f.val("_self"),"url"==a?(d.val("http://"),f.val("_blank"),$(".froala").hide()):(uri=e.val().toLowerCase().replace(/[^a-zA-Z0-9\s]/g,"").replace(/ /g,"-"),d.val("cms/"+uri),d.attr("readonly","readonly"),e.bind("input",function(){uri=e.val().toLowerCase().replace(/[^a-zA-Z0-9\s]/g,"").replace(/ /g,"-"),d.val("cms/"+uri)}))}),j($("#logoselect option:selected").val(),$("#logodata_wrapper")),j($("#logo2select option:selected").val(),$("#logo2data_wrapper")),j($("#bgselect option:selected").val(),$("#bgdata_wrapper")),j($("#mediaselect option:selected").val(),$("#mediadata_wrapper")),j($("#bgsiderselect option:selected").val(),$("#bgsiderdata_wrapper")),j($("#navselect option:selected").val(),$("#navdata_wrapper")),j($("#navrightselect option:selected").val(),$("#navrightdata_wrapper")),j($("#uitextselect option:selected").val(),$("#uitextdata_wrapper")),j($("#uitexthoverselect option:selected").val(),$("#uitexthoverdata_wrapper")),j($("#uiblockhoverselect option:selected").val(),$("#uiblockhoverdata_wrapper")),j($("#uitextactiveselect option:selected").val(),$("#uitextactivedata_wrapper")),j($("#uisidertextselect option:selected").val(),$("#uisidertextdata_wrapper")),j($("#uisidertexthoverselect option:selected").val(),$("#uisidertexthoverdata_wrapper")),j($("#uisidertextactiveselect option:selected").val(),$("#uisidertextactivedata_wrapper")),$("#bgselect, #mediaselect, #logoselect, #logo2select, #navselect, #navrightselect, #bgsiderselect, #uitextselect, #uitexthoverselect, #uiblockhoverselect, #uitextactiveselect, #uisidertextselect, #uisidertexthoverselect, #uisidertextactiveselect").on("change",function(){var a=this.value,b=$(this).next().next();b.empty(),j(a,b)})});